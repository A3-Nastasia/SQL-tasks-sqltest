## Задание 1
Найдите среднее время проката фильма (в днях). Отобразите результат в колонке с именем `average_rental_time`. \
Время аренды рассчитывается как разница между `return_date` и `rental_date` в таблице аренда. \
Округлите результат до ближайшего целого числа.
```
SELECT 
    ROUND(AVG(TIMESTAMPDIFF(DAY, rental_date, return_date))) AS average_rental_time
FROM rental
```

## Задание 2
Напишите запрос для расчета суммы платежей за каждый месяц и отображения результатов в порядке убывания месяца платежа. \
Запрос должен вернуть только два столбца: `payment_month` – месяц платежа (в формате «ГГГГ-ММ») и `payment_amount` – общая сумма платежа за каждый месяц.
```
SELECT
    DATE_FORMAT(payment_date, '%Y-%m') AS payment_month,
    SUM(amount) AS payment_amount
FROM payment
GROUP BY DATE_FORMAT(payment_date, '%Y-%m')
ORDER BY payment_month DESC
```

## Задание 3
Найдите среднее время проката фильма (в днях). Отобразите результат в колонке с именем `average_rental_time`. \
Время аренды рассчитывается как разница между `return_date` и `rental_date` в таблице `rental`. \
Округлите результат до ближайшего целого числа.
```
SELECT ROUND(AVG(DATEDIFF(return_date, rental_date))) AS average_rental_time
FROM rental
```

## Задание 4
Найти количество сотрудников в каждом подразделении. \
Выведите имя подразделения `DEPARTMENT` и число сотрудников в нём `EMP_COUNT`. \
Отсортируйте результат по убыванию числа сотрудников, затем по названию подразделения по алфавиту.
```
SELECT 
    DEPARTMENT, 
    COALESCE(COUNT(EMP_NO),0) AS EMP_COUNT
FROM DEPARTMENT d

LEFT JOIN EMPLOYEE e
ON e.DEPT_NO = d.DEPT_NO

GROUP BY DEPARTMENT
ORDER BY EMP_COUNT DESC, DEPARTMENT
```

## Задание 5
Найти количество фильмов в каждой категории. Выведите таблицу состоящую из двух колонок `category` и `film_count` отсортируйте её по названию категорий в алфавитном порядке.
```
SELECT 
    c.name AS category,
    COUNT(DISTINCT fc.film_id) AS film_count
FROM film_category fc

LEFT JOIN category c
ON fc.category_id = c.category_id

GROUP BY c.name
ORDER BY c.name
```